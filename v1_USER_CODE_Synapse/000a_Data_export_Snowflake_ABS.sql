create or replace stage padak_azure_stage_csv
  url='azure://keboolabenchmark.blob.core.windows.net/padak'
  credentials=(azure_sas_token='?sv=2019-12-12&ss=bfqt&srt=sco&sp=rwdlacupx&se=2020-12-30T18:38:01Z&st=2020-12-28T01:38:01Z&spr=https&sig=xxx')
  file_format = (
    TYPE = 'CSV'
    FIELD_DELIMITER = ','
    FIELD_OPTIONALLY_ENCLOSED_BY = '\"'
    COMPRESSION='GZIP'
    TIMESTAMP_FORMAT = 'YYYY-MM-DD HH24:MI:SS'
);

/* 
=====================================================
-- export to ABS
-- CSV GZIP
-- 100M slices
*/

copy into @padak_azure_stage_csv/USER_TRANSF/CSV/FILE_100M/TPCDS_100/CALL_CENTER/CALL_CENTER from PADAK_TPCDS.PUBLIC.CALL_CENTER MAX_FILE_SIZE=1000000000;
copy into @padak_azure_stage_csv/USER_TRANSF/CSV/FILE_100M/TPCDS_100/CATALOG_PAGE/CATALOG_PAGE from PADAK_TPCDS.PUBLIC.CATALOG_PAGE MAX_FILE_SIZE=1000000000;
copy into @padak_azure_stage_csv/USER_TRANSF/CSV/FILE_100M/TPCDS_100/CATALOG_RETURNS/CATALOG_RETURNS from PADAK_TPCDS.PUBLIC.CATALOG_RETURNS MAX_FILE_SIZE=1000000000;
copy into @padak_azure_stage_csv/USER_TRANSF/CSV/FILE_100M/TPCDS_100/CATALOG_SALES/CATALOG_SALES from PADAK_TPCDS.PUBLIC.CATALOG_SALES MAX_FILE_SIZE=1000000000;
copy into @padak_azure_stage_csv/USER_TRANSF/CSV/FILE_100M/TPCDS_100/CUSTOMER/CUSTOMER from PADAK_TPCDS.PUBLIC.CUSTOMER MAX_FILE_SIZE=1000000000;
copy into @padak_azure_stage_csv/USER_TRANSF/CSV/FILE_100M/TPCDS_100/CUSTOMER_ADDRESS/CUSTOMER_ADDRESS from PADAK_TPCDS.PUBLIC.CUSTOMER_ADDRESS MAX_FILE_SIZE=1000000000;
copy into @padak_azure_stage_csv/USER_TRANSF/CSV/FILE_100M/TPCDS_100/CUSTOMER_DEMOGRAPHICS/CUSTOMER_DEMOGRAPHICS from PADAK_TPCDS.PUBLIC.CUSTOMER_DEMOGRAPHICS MAX_FILE_SIZE=1000000000;
copy into @padak_azure_stage_csv/USER_TRANSF/CSV/FILE_100M/TPCDS_100/DATE_DIM/DATE_DIM from PADAK_TPCDS.PUBLIC.DATE_DIM MAX_FILE_SIZE=1000000000;
copy into @padak_azure_stage_csv/USER_TRANSF/CSV/FILE_100M/TPCDS_100/HOUSEHOLD_DEMOGRAPHICS/HOUSEHOLD_DEMOGRAPHICS from PADAK_TPCDS.PUBLIC.HOUSEHOLD_DEMOGRAPHICS MAX_FILE_SIZE=1000000000;
copy into @padak_azure_stage_csv/USER_TRANSF/CSV/FILE_100M/TPCDS_100/INCOME_BAND/INCOME_BAND from PADAK_TPCDS.PUBLIC.INCOME_BAND MAX_FILE_SIZE=1000000000;
copy into @padak_azure_stage_csv/USER_TRANSF/CSV/FILE_100M/TPCDS_100/INVENTORY/INVENTORY from PADAK_TPCDS.PUBLIC.INVENTORY MAX_FILE_SIZE=1000000000;
copy into @padak_azure_stage_csv/USER_TRANSF/CSV/FILE_100M/TPCDS_100/ITEM/ITEM from PADAK_TPCDS.PUBLIC.ITEM MAX_FILE_SIZE=1000000000;
copy into @padak_azure_stage_csv/USER_TRANSF/CSV/FILE_100M/TPCDS_100/PROMOTION/PROMOTION from PADAK_TPCDS.PUBLIC.PROMOTION MAX_FILE_SIZE=1000000000;
copy into @padak_azure_stage_csv/USER_TRANSF/CSV/FILE_100M/TPCDS_100/REASON/REASON from PADAK_TPCDS.PUBLIC.REASON MAX_FILE_SIZE=1000000000;
copy into @padak_azure_stage_csv/USER_TRANSF/CSV/FILE_100M/TPCDS_100/SHIP_MODE/SHIP_MODE from PADAK_TPCDS.PUBLIC.SHIP_MODE MAX_FILE_SIZE=1000000000;
copy into @padak_azure_stage_csv/USER_TRANSF/CSV/FILE_100M/TPCDS_100/STORE/STORE from PADAK_TPCDS.PUBLIC.STORE MAX_FILE_SIZE=1000000000;
copy into @padak_azure_stage_csv/USER_TRANSF/CSV/FILE_100M/TPCDS_100/STORE_RETURNS/STORE_RETURNS from PADAK_TPCDS.PUBLIC.STORE_RETURNS MAX_FILE_SIZE=1000000000;

-- STORE_SALES is empty table => no ABS export
-- copy into @padak_azure_stage_csv/USER_TRANSF/CSV/FILE_100M/TPCDS_100/STORE_SALES/STORE_SALES from PADAK_TPCDS.PUBLIC.STORE_SALES MAX_FILE_SIZE=1000000000;

copy into @padak_azure_stage_csv/USER_TRANSF/CSV/FILE_100M/TPCDS_100/TIME_DIM/TIME_DIM from PADAK_TPCDS.PUBLIC.TIME_DIM MAX_FILE_SIZE=1000000000;
copy into @padak_azure_stage_csv/USER_TRANSF/CSV/FILE_100M/TPCDS_100/WAREHOUSE/WAREHOUSE from PADAK_TPCDS.PUBLIC.WAREHOUSE MAX_FILE_SIZE=1000000000;
copy into @padak_azure_stage_csv/USER_TRANSF/CSV/FILE_100M/TPCDS_100/WEB_PAGE/WEB_PAGE from PADAK_TPCDS.PUBLIC.WEB_PAGE MAX_FILE_SIZE=1000000000;
copy into @padak_azure_stage_csv/USER_TRANSF/CSV/FILE_100M/TPCDS_100/WEB_RETURNS/WEB_RETURNS from PADAK_TPCDS.PUBLIC.WEB_RETURNS MAX_FILE_SIZE=1000000000;
copy into @padak_azure_stage_csv/USER_TRANSF/CSV/FILE_100M/TPCDS_100/WEB_SALES/WEB_SALES from PADAK_TPCDS.PUBLIC.WEB_SALES MAX_FILE_SIZE=1000000000;
copy into @padak_azure_stage_csv/USER_TRANSF/CSV/FILE_100M/TPCDS_100/WEB_SITE/WEB_SITE from PADAK_TPCDS.PUBLIC.WEB_SITE MAX_FILE_SIZE=1000000000;

